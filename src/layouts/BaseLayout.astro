---
const {
  title,
  description,
  schema,
  prevUrl,
  nextUrl,
  ogImage = "/og-default.jpg"
} = Astro.props;
---

<!DOCTYPE html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <title>{title}</title>
  <meta name="description" content={description} />
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QC2JTMPDS5"></script>
  <script is:inline>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}

    gtag('consent', 'default', {
      ad_storage: 'denied',
      analytics_storage: 'denied'
    });

    gtag('js', new Date());

    gtag('config', 'G-QC2JTMPDS5', {
      anonymize_ip: true,
      send_page_view: true
    });
  </script>
  <!-- Cloudflare Web Analytics -->
  <script defer 
    src='https://static.cloudflareinsights.com/beacon.min.js' 
    data-cf-beacon='{"token": "4a23c53b40e34662a6ed1dd09dfb8a38"}'>
  </script>
  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Eagle Quarter Newbury" />
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:url" content={Astro.url} />
  <meta property="og:image" content={ogImage} />
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={title} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={ogImage} />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Canonical -->
  <link rel="canonical" href={Astro.url} />
  <!-- Basic SEO -->
  <meta name="robots" content="index, follow" />
  <link rel="sitemap" href="/sitemap-index.xml" />
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  >
  <link rel="icon" href="/favicon.svg" sizes="any" />
  <!-- JSON-LD Schema -->
  {schema && (
    <script type="application/ld+json">
      {JSON.stringify(schema)}
    </script>
  )}
  {prevUrl && <link rel="prev" href={prevUrl} />}
  {nextUrl && <link rel="next" href={nextUrl} />}
  <!-- Styles -->
   <style is:global>

    :root {
      --bg: #181a1b;
      --text: #cdc8c2;
      --muted: #9e9589;
      --accent: #a7f6f6;
      --border: #363b3d;
      --max-width: 1100px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      color: var(--text);
      background: var(--bg);
      line-height: 1.6;
    }

    a {
      color: var(--accent);
      text-decoration: none;
    }

    a:hover { text-decoration: underline; }

    header {
      border-bottom: 1px solid var(--border);
      background: #181a1b;
      position: relative;
      z-index: 100;
    }

    .container {
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 0 1rem;
    }

    .nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 64px;
      position: relative; /* ✅ REQUIRED */
    }

    .brand {
      font-weight: 700;
      font-size: 1.6rem;
    }

    .brand a {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: inherit;
      text-decoration: none;
    }

    .brand-logo {
      width: 28px;
      height: 28px;
      display: block;
    }

    .brand a:hover {
      opacity: 0.65;
    }

    .nav-links {
      display: flex;
      gap: 1.2rem;
    }

    .nav-links a {
      font-weight: 500;
      color: var(--text);
    }

    .nav-links a:hover {
      opacity: 0.65;
    }

    .menu-toggle {
      display: none;
      background: none;
      border: none;
      font-size: 1.5rem;
    }

    main { padding: 3rem 0; }

    h1 {
      font-size: clamp(2rem, 4vw, 2.6rem);
      line-height: 1.2;
      margin-bottom: 1rem;
    }

    h2 {
      margin-top: 3rem;
      margin-bottom: 0.5rem;
      font-size: 1.6rem;
    }

    p { max-width: 70ch; }

    .hero { padding-bottom: 2rem; }

    .hero-wrapper {
      position: relative;
      margin: 1.5rem 0;
      border-radius: 8px;
      overflow: hidden;
    }

    .hero-image {
      width: 100%;
      display: block;
      border-radius: 8px;
      transition: transform 0.3s ease;
    }

    .hero-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(
        to top,
        rgba(0, 0, 0, 0.75),
        rgba(0, 0, 0, 0.2)
      );
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 1rem;
      color: white;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .hero-source {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .hero-cta {
      font-weight: 600;
      font-size: 1rem;
    }

    .hero-wrapper:hover .hero-overlay {
      opacity: 1;
    }

    .hero-wrapper:hover .hero-image {
      transform: scale(1.03);
    }

    .muted { color: var(--muted); }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .card {
      display: block;
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      background: #1b1d1e;
      color: inherit;
      text-decoration: none;
      transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
    }

    .card:hover {
      transform: translateY(-2px);      
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(235, 232, 232, 0.06);
      opacity: 0.65;
    }
    .card-image {
      width: 100%;
      height: 160px;
      object-fit: cover;
      display: block;
    }

    .card strong {
      display: block;
      margin-bottom: 0.25rem;
    }

    .card-body {
      padding: 1rem 1.1rem;
    }

    .card:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: 3px;
    }

    .news-card {
      display: block;
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      background: #1b1d1e;
      color: inherit;
      text-decoration: none;
      transition: transform 0.15s ease, box-shadow 0.15s ease, border-color 0.15s ease;
    }

    .news-card:hover {
      transform: translateY(-2px);
      border-color: var(--accent);
      box-shadow: 0 4px 12px rgba(235, 232, 232, 0.06);
      opacity: 0.65;
    }

    .news-card-image {
      width: 100%;
      height: 160px;
      object-fit: cover;
      display: block;
    }

    .news-card-body {
      padding: 1rem 1.1rem;
    }

    .news-card-body strong {
      display: block;
      margin-bottom: 0.25rem;
    }

    iframe {
      width: 100%;
      height: 360px;
      border: 0;
      margin-top: 1rem;
    }

    footer {
      border-top: 1px solid var(--border);
      margin-top: 4rem;
      padding: 2rem 0;
      font-size: 0.9rem;
      color: var(--muted);
    }

    .footer-inner {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .social-links {
      display: flex;
      gap: 1rem;
      font-size: 0.9rem;
    }

    .social-links a {
      color: var(--muted);
    }

    .social-links a:hover {
      color: var(--text);
    }

    .social-links svg {
      width: 30px;
      height: 30px;
      vertical-align: middle;
      fill: var(--muted);
    }

    .social-links a:hover svg {
      fill: var(--accent);
    }

    .pagination {
      display: flex;
      justify-content: space-between;
      margin-top: 3rem;
      gap: 1rem;
    }

    .pagination a {
      border: 1px solid var(--border);
      padding: 0.6rem 1rem;
      border-radius: 6px;
      font-weight: 500;
    }

    .pagination a:hover {
      border-color: var(--accent);
    }

    @media (max-width: 768px) {
      .nav-links {
        position: absolute;
        top: 64px;
        left: 0;
        right: 0;
        background: var(--bg);
        border-bottom: 1px solid var(--border);
        padding: 1rem;

        display: flex;
        flex-direction: column;
        gap: 0.75rem;

        /* animation */
        opacity: 0;
        transform: translateY(-10px);
        pointer-events: none;

        transition:
          opacity 0.4s ease,
          transform 0.4s ease;
      }

      .nav-links.active {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
      }

      .nav-links a {
        padding: 0.5rem 0;
      }

      .brand span {
        display: none;
      }

      .menu-toggle {
        display: block;
        color: var(--text);
      }
    }

  </style>
  <!-- Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Place",
    "name": "Eagle Quarter Newbury",
    "address": {
      "@type": "PostalAddress",
      "addressLocality": "Newbury",
      "addressRegion": "Berkshire",
      "addressCountry": "GB"
    }
  }
  </script>
</head>

<body>

<header>
  <div class="container nav">
  <div class="brand">
    <a href="/">
      <img
        src="/logo.svg"
        alt=""
        aria-hidden="true"
        class="brand-logo"
      />
      <span>Eagle Quarter Newbury</span>
    </a>
  </div>

  <button
    class="menu-toggle"
    aria-label="Toggle navigation"
    aria-expanded="false"
    aria-controls="navLinks"
  >
    ☰
  </button>

  <nav
    class="nav-links"
    id="navLinks"
    aria-hidden="true"
  >
    <a href="/eagle-quarter-newbury-development/">Development</a>
    <a href="/eagle-quarter-newbury-news/">News</a>
    <a href="/eagle-quarter-newbury-planning-permission/">Planning</a>
    <a href="/eagle-quarter-newbury-investment/">Investment</a>
    <a href="/eagle-quarter-newbury-location/">Location</a>
  </nav>
  </div>
</header>

<main class="container">
  <slot />
</main>

<footer>
  <div class="container footer-inner">
    <p>
      Eagle Quarter Newbury is a landmark redevelopment in Berkshire. This site
      provides independent news, updates and information on the Eagle Quarter
      development in Newbury town centre.
    </p>

    <nav class="social-links" aria-label="Social links">
      <a
        href="https://github.com/fluffycheese/eaglequarter"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="GitHub"
      >
        <!-- GitHub SVG -->
        <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path d="M12 0.297C5.37 0.297 0 5.667 0 12.297c0 5.302 3.438 9.8 8.205 11.387.6.113.82-.26.82-.577v-2.023c-3.338.726-4.033-1.61-4.033-1.61-.546-1.387-1.333-1.756-1.333-1.756-1.09-.744.083-.729.083-.729 1.205.084 1.84 1.237 1.84 1.237 1.07 1.834 2.807 1.304 3.492.997.108-.775.418-1.304.76-1.603-2.665-.3-5.467-1.334-5.467-5.933 0-1.31.468-2.38 1.236-3.222-.124-.303-.536-1.523.117-3.176 0 0 1.008-.322 3.3 1.23a11.44 11.44 0 0 1 3.003-.404c1.02.005 2.046.137 3.003.403 2.289-1.552 3.295-1.23 3.295-1.23.655 1.653.243 2.873.12 3.176.77.842 1.235 1.912 1.235 3.222 0 4.61-2.807 5.628-5.48 5.922.429.37.813 1.1.813 2.222v3.293c0 .32.216.694.825.576C20.565 22.092 24 17.595 24 12.297 24 5.667 18.627.297 12 .297z"/>
        </svg>
      </a>

      <a
        href="https://twitter.com/YOUR_HANDLE"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="Twitter"
      >
        <!-- Twitter SVG -->
        <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path d="M24 4.557a9.832 9.832 0 0 1-2.828.775 4.932 4.932 0 0 0 2.165-2.724 9.864 9.864 0 0 1-3.127 1.195 4.924 4.924 0 0 0-8.39 4.482A13.978 13.978 0 0 1 1.671 3.149a4.922 4.922 0 0 0 1.523 6.574 4.902 4.902 0 0 1-2.231-.616c-.054 2.28 1.581 4.415 3.949 4.89a4.936 4.936 0 0 1-2.224.085 4.924 4.924 0 0 0 4.604 3.417 9.867 9.867 0 0 1-6.102 2.105c-.395 0-.785-.023-1.17-.067a13.945 13.945 0 0 0 7.548 2.212c9.058 0 14.01-7.514 14.01-14.01 0-.213-.004-.425-.014-.636A10.012 10.012 0 0 0 24 4.557z"/>
        </svg>
      </a>

      <a
        href="https://facebook.com/YOUR_PAGE"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="Facebook"
      >
        <!-- Facebook SVG -->
        <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path d="M22.675 0H1.326C.593 0 0 .593 0 1.326v21.348C0 23.406.593 24 1.326 24H12.82v-9.294H9.692v-3.622h3.128V8.413c0-3.1 1.894-4.788 4.659-4.788 1.325 0 2.463.099 2.794.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.31h3.587l-.467 3.622h-3.12V24h6.116c.733 0 1.326-.593 1.326-1.326V1.326C24 .593 23.407 0 22.675 0z"/>
        </svg>
      </a>

      <a
        href="https://linkedin.com/in/YOUR_PROFILE"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="LinkedIn"
      >
        <!-- LinkedIn SVG -->
        <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path d="M22.23 0H1.77C.792 0 0 .774 0 1.728v20.544C0 23.226.792 24 1.77 24h20.46C23.208 24 24 23.226 24 22.272V1.728C24 .774 23.208 0 22.23 0zM7.08 20.452H3.56V9h3.52v11.452zM5.32 7.556a2.043 2.043 0 1 1 0-4.085 2.043 2.043 0 0 1 0 4.085zM20.452 20.452h-3.521v-5.604c0-1.335-.024-3.055-1.86-3.055-1.862 0-2.148 1.454-2.148 2.957v5.702H9.42V9h3.379v1.561h.047c.47-.89 1.615-1.83 3.324-1.83 3.552 0 4.207 2.338 4.207 5.377v6.904z"/>
        </svg>
      </a>
    </nav>

    <p>
      <a href="/eagle-quarter-newbury-privacy/">Privacy Policy</a>
    </p>

  </div>
</footer>
<!-- Menu toggle script -->
<script is:inline>
  const toggle = document.querySelector('.menu-toggle');
  const nav = document.getElementById('navLinks');
  function openMenu() {
    nav.classList.add('active');
    toggle.setAttribute('aria-expanded', 'true');
    nav.setAttribute('aria-hidden', 'false');
  }
  function closeMenu() {
    nav.classList.remove('active');
    toggle.setAttribute('aria-expanded', 'false');
    nav.setAttribute('aria-hidden', 'true');
  }
  toggle.addEventListener('click', (e) => {
    e.stopPropagation();
    nav.classList.contains('active') ? closeMenu() : openMenu();
  });
  /* click outside */
  document.addEventListener('click', (e) => {
    if (!nav.contains(e.target) && !toggle.contains(e.target)) {
      closeMenu();
    }
  });
  /* escape key */
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeMenu();
      toggle.focus();
    }
  });
</script>
<script is:inline>
  // Advanced Engagement Tracking
  function trackEvent(name, params = {}) {
    if (typeof gtag === 'function') {
      gtag('event', name, params);
    }
  }
  // Scroll depth tracking
  (() => {
    const thresholds = [25, 50, 75];
    const fired = new Set();

    function onScroll() {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      if (docHeight <= 0) return;

      const percent = Math.round((scrollTop / docHeight) * 100);

      thresholds.forEach(t => {
        if (percent >= t && !fired.has(t)) {
          fired.add(t);
          trackEvent('scroll_depth', {
            percent: t,
            page_path: window.location.pathname
          });
        }
      });
    }

    window.addEventListener('scroll', onScroll, { passive: true });
  })();
  // Time-on-page buckets
  (() => {
    const buckets = [15, 30, 60, 120];
    const fired = new Set();

    buckets.forEach(seconds => {
      setTimeout(() => {
        if (!fired.has(seconds)) {
          fired.add(seconds);
          trackEvent('time_on_page', {
            seconds,
            page_path: window.location.pathname
          });
        }
      }, seconds * 1000);
    });
  })();
  // Outbound article tracking
  document.addEventListener('click', (e) => {
    const link = e.target.closest('a[href]');
    if (!link) return;

    const url = new URL(link.href, window.location.origin);
    // Track "Read original article" links
    if (link.dataset.original === 'true') {
      trackEvent('original_article_click', {
        source: url.hostname,
        href: url.href
      });
      return;
    }
    // Generic outbound links
    if (url.origin !== window.location.origin) {
      trackEvent('outbound_click', {
        href: url.href
      });
    }
  });
  // Tag engagement tracking
  document.addEventListener('click', (e) => {
    const tag = e.target.closest('[data-tag]');
    if (!tag) return;

    trackEvent('tag_click', {
      tag: tag.dataset.tag,
      page_path: window.location.pathname
    });
  });
</script>
</body>
</html>
